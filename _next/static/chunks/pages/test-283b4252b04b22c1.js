(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[378],{8306:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/test",function(){return n(4249)}])},4249:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var a=n(1527),r=n(7555),o=n.n(r),l=n(959),i=n(1576),s=n(744),c=n(9163);function d(e,t){return new Promise(n=>{let a=setTimeout(n,e);t.addEventListener("abort",()=>{clearTimeout(a),n()})})}function p(e,t){let n=Array.from({length:t-e+1},(t,n)=>e+n);return[...n,...[...n].reverse().slice(1)]}function u(e){return e[Math.floor(Math.random()*e.length)]}function f(e){return t=>{let{loaded:n,total:a}=t;e.replaceLast("  Loading… ".concat(n," / ").concat(a))}}async function y(e,t,n,a,r){for(let o of(a.append("  scale vel:100"),a.append("  ▶ …"),t)){if(r.aborted)return;let t=i.jC.fromMidi(o);e.start({note:o,duration:(n-30)/1e3,velocity:100,onStart:()=>a.replaceLast("  ▶ ".concat(t," vel:100")),onEnded:()=>a.replaceLast("  ■ ".concat(t," vel:100"))}),await d(n,r)}if(r.aborted)return;let o=t[0],l=i.jC.fromMidi(o);a.append("  velocity test: ".concat(l)),a.append("  ▶ …");for(let t=0;t<20;t++){if(r.aborted)return;let i=Math.round(127*(1-t/19));e.start({note:o,duration:(n-30)/1e3,velocity:i,onStart:()=>a.replaceLast("  ▶ ".concat(l," vel:").concat(i)),onEnded:()=>a.replaceLast("  ■ ".concat(l," vel:").concat(i))}),await d(n,r)}}async function m(e,t,n){let a=e.getGroupNames();for(let r of(t.append("  Groups: ".concat(a.join("  "))),t.append("  ▶ …"),a)){if(n.aborted)return;let a=Math.floor(127*Math.random())+1;e.start({note:r,velocity:a,onStart:()=>t.replaceLast("  ▶ ".concat(r," vel:").concat(a)),onEnded:()=>t.replaceLast("  ■ ".concat(r," vel:").concat(a))}),await d(400,n)}}let g=[{label:"SplendidGrandPiano",async run(e,t,n){t.append("  Loading… 0 / ?");let a=new s.ab(e,{onLoadProgress:f(t)});try{if(await a.load,n.aborted)return;t.append("  ready"),await y(a,p(48,72),200,t,n)}finally{a.disconnect()}}},{label:"Soundfont",async run(e,t,n){let a=u((0,s.Dy)());t.append("  Preset: ".concat(a," (MusyngKite)")),t.append("  Loading… 0 / ?");let r=new s.Be(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await y(r,p(48,72),200,t,n)}finally{r.disconnect()}}},{label:"ElectricPiano",async run(e,t,n){let a=u((0,s.mb)());t.append("  Preset: ".concat(a)),t.append("  Loading… 0 / ?");let r=new s.xU(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await y(r,p(48,72),200,t,n)}finally{r.disconnect()}}},{label:"Mallet",async run(e,t,n){let a=u((0,s.wz)());t.append("  Preset: ".concat(a)),t.append("  Loading… 0 / ?");let r=new s.Jp(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await y(r,p(48,72),200,t,n)}finally{r.disconnect()}}},{label:"Mellotron",async run(e,t,n){let a=u((0,s.Zx)());t.append("  Preset: ".concat(a)),t.append("  Loading… 0 / ?");let r=new s.a0(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await y(r,p(48,72),200,t,n)}finally{r.disconnect()}}},{label:"Smolken",async run(e,t,n){let a=u((0,s.co)());t.append("  Preset: ".concat(a)),t.append("  Loading… 0 / ?");let r=new s.TU(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await y(r,p(36,60),200,t,n)}finally{r.disconnect()}}},{label:"DrumMachine",async run(e,t,n){let a=u((0,s.mK)());t.append("  Preset: ".concat(a)),t.append("  Loading… 0 / ?");let r=new s.No(e,{instrument:a,onLoadProgress:f(t)});try{if(await r.load,n.aborted)return;t.append("  ready"),await m(r,t,n)}finally{r.disconnect()}}},{label:"Versilian",async run(e,t,n){t.append("  Fetching instrument list…");let a=await (0,s.o6)();if(n.aborted)return;let r=u(a);t.append("  Preset: ".concat(r)),t.append("  Loading… 0 / ?");let o=new s.Dc(e,{instrument:r,onLoadProgress:f(t)});try{if(await o.load,n.aborted)return;t.append("  ready"),await y(o,p(48,72),200,t,n)}finally{o.disconnect()}}}];async function b(e,t,n){for(let a of g){if(n.aborted)break;t.append("━━━ ".concat(a.label));let r=performance.now();try{if(await a.run(e,t,n),!n.aborted){let e=((performance.now()-r)/1e3).toFixed(1);t.append("  ✓ done (".concat(e,"s)"))}}catch(e){t.append("  ✗ ".concat(e instanceof Error?e.message:String(e)))}}n.aborted||(t.append("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),t.append("All instruments tested."))}function w(){let[e,t]=(0,l.useState)(!1),[n,r]=(0,l.useState)([]),i=(0,l.useRef)(null),s=(0,l.useRef)(null),d=e=>r(t=>[...t,e]),p=e=>r(t=>t.length?[...t.slice(0,-1),e]:[e]);return(0,l.useEffect)(()=>{var e;null===(e=s.current)||void 0===e||e.scrollTo({top:s.current.scrollHeight,behavior:"smooth"})},[n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o(),{children:(0,a.jsx)("title",{children:"smplr — instrument test"})}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-950 text-green-300 p-8 font-mono text-sm",children:[(0,a.jsx)("h1",{className:"text-base mb-4 text-green-400",children:"smplr instrument test"}),(0,a.jsx)("button",{onClick:function(){if(e){var n;null===(n=i.current)||void 0===n||n.abort(),t(!1)}else{r([]);let e=new AbortController;i.current=e,t(!0),b((0,c.k)(),{append:d,replaceLast:p},e.signal).finally(()=>{t(!1)})}},className:"px-4 py-2 rounded bg-green-900 hover:bg-green-800 text-green-100 font-bold mb-6",children:e?"⏸ Pause":"▶ Play"}),(0,a.jsxs)("div",{ref:s,className:"overflow-y-auto h-[72vh] leading-relaxed space-y-px",children:[n.map((e,t)=>(0,a.jsx)("div",{className:e.startsWith("━")?"text-green-500 pt-2":e.startsWith("  ✓")?"text-green-400":e.startsWith("  ✗")?"text-red-400":e.startsWith("  ▶")?"text-yellow-300":e.startsWith("  ■")?"text-green-200":"text-green-600",children:e},t)),e&&(0,a.jsx)("div",{className:"text-green-700 animate-pulse select-none",children:"▊"})]})]})]})}}},function(e){e.O(0,[714,810,888,774,179],function(){return e(e.s=8306)}),_N_E=e.O()}]);